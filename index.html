<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ•¯ï¸ ×§×¨×™××ª ×ª×”×™×œ×™× ×§×‘×•×¦×ª×™×ª - ××—×–×•×¨ ××•×˜×•××˜×™ ğŸ•¯ï¸</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Heebo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
        }
        
        .progress-circle {
            transform: rotate(-90deg);
        }
        
        .progress-circle-bg {
            fill: none;
            stroke: #e2e8f0;
            stroke-width: 8;
        }
        
        .progress-circle-fill {
            fill: none;
            stroke-linecap: round;
            stroke-width: 8;
            transition: stroke-dasharray 0.5s ease-in-out;
        }
        
        .daily-circle {
            stroke: #3b82f6;
        }
        
        .monthly-circle {
            stroke: #10b981;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin: 16px;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Heebo', sans-serif;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .input {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: 'Heebo', sans-serif;
            width: 100%;
            margin-bottom: 12px;
        }
        
        .input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .participant-card {
            background: #f8fafc;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status-completed {
            background: #dcfce7;
            color: #166534;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fef2f2;
            color: #991b1b;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .chapter-display {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            text-align: center;
        }
        
        .app-title {
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: 32px;
        }
        
        .date-info {
            background: linear-gradient(135deg, #e0f2fe 0%, #0284c7 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            color: white;
            text-align: center;
        }
        
        .cycle-info {
            background: linear-gradient(135deg, #f0fdf4 0%, #16a34a 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            color: white;
            text-align: center;
        }
        
        .whatsapp-message {
            background: #f0fdf4;
            border: 2px solid #22c55e;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            font-family: monospace;
            white-space: pre-line;
            direction: ltr;
            text-align: left;
        }
        
        .data-source-info {
            background: linear-gradient(135deg, #fef3c7 0%, #f59e0b 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            color: #92400e;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // × ×ª×•× ×™ ×—×œ×•×§×ª ×”×ª×”×™×œ×™× ×œ×¤×™ ×™××™×
        const tehillimDivision = {
            1: ['×', '×‘', '×’', '×“', '×”', '×•', '×–', '×—', '×˜'],
            2: ['×™', '×™×', '×™×‘', '×™×’', '×™×“', '×˜×•', '×˜×–', '×™×–'],
            3: ['×™×—', '×™×˜', '×›', '×›×', '×›×‘'],
            4: ['×›×’', '×›×“', '×›×”', '×›×•', '×›×–', '×›×—'],
            5: ['×›×˜', '×œ', '×œ×', '×œ×‘', '×œ×’', '×œ×“'],
            6: ['×œ×”', '×œ×•', '×œ×–', '×œ×—'],
            7: ['×œ×˜', '×', '××', '××‘', '××’'],
            8: ['××“', '××”', '××•', '××–', '××—'],
            9: ['××˜', '× ', '× ×', '× ×‘', '× ×’', '× ×“'],
            10: ['× ×”', '× ×•', '× ×–', '× ×—', '× ×˜'],
            11: ['×¡', '×¡×', '×¡×‘', '×¡×’', '×¡×“', '×¡×”'],
            12: ['×¡×•', '×¡×–', '×¡×—'],
            13: ['×¡×˜', '×¢', '×¢×'],
            14: ['×¢×‘', '×¢×’', '×¢×“', '×¢×”', '×¢×•'],
            15: ['×¢×–', '×¢×—'],
            16: ['×¢×˜', '×¤', '×¤×', '×¤×‘'],
            17: ['×¤×’', '×¤×“', '×¤×”', '×¤×•', '×¤×–'],
            18: ['×¤×—', '×¤×˜'],
            19: ['×¦', '×¦×', '×¦×‘', '×¦×’', '×¦×“', '×¦×”'],
            20: ['×¦×•', '×¦×–', '×¦×—', '×¦×˜', '×§'],
            21: ['×§×', '×§×‘', '×§×’', '×§×“', '×§×”'],
            22: ['×§×•', '×§×–', '×§×—', '×§×˜'],
            23: ['×§×™', '×§×™×', '×§×™×‘', '×§×™×’', '×§×™×“', '×§×˜×•', '×§×˜×–', '×§×™×–', '×§×™×—'],
            24: ['×§×™×˜'],
            25: ['×§×›', '×§×›×', '×§×›×‘', '×§×›×’', '×§×›×“', '×§×›×”', '×§×›×•', '×§×›×–', '×§×›×—', '×§×›×˜', '×§×œ', '×§×œ×', '×§×œ×‘', '×§×œ×’', '×§×œ×“'],
            26: ['×§×œ×”', '×§×œ×•', '×§×œ×–', '×§×œ×—', '×§×œ×˜'],
            27: ['×§×', '×§××', '×§××‘', '×§××’', '×§××“', '×§××”'],
            28: ['×§××•', '×§××–', '×§××—', '×§××˜'],
            29: ['×§× '],
            30: ['×ª×”×™×œ×” ×œ×“×•×“']
        };

        // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×œ×—×™×©×•×‘ ×ª××¨×™×›×™×
        const getTodayInfo = () => {
            const today = new Date();
            const dayOfMonth = today.getDate();
            const month = today.getMonth() + 1;
            const year = today.getFullYear();
            
            // ×‘×“×™×§×” ×× ×™×© ×“×¨×™×¡×” ×©×œ ××—×–×•×¨
            const cycleOverride = localStorage.getItem('cycleOverride');
            let cycleDay, completedCycles;
            
            if (cycleOverride) {
                const override = JSON.parse(cycleOverride);
                const originalDate = new Date(override.originalDate);
                const currentDate = new Date();
                const daysDiff = Math.floor((currentDate - originalDate) / (1000 * 60 * 60 * 24));
                
                cycleDay = ((override.overrideCycleDay - 1 + daysDiff) % 30) + 1;
                completedCycles = Math.floor((override.overrideCycleDay - 1 + daysDiff) / 30);
            } else {
                // ×—×™×©×•×‘ ×™×•× ×‘××—×–×•×¨ ×¨×’×™×œ (1-30)
                cycleDay = ((dayOfMonth - 1) % 30) + 1;
                completedCycles = Math.floor((dayOfMonth - 1) / 30);
            }
            
            return {
                dayOfMonth,
                month,
                year,
                cycleDay,
                completedCycles,
                hebrewDate: today.toLocaleDateString('he-IL')
            };
        };

        const getParticipantAssignment = (participantId, todayInfo) => {
            // ×›×œ ××©×ª×ª×£ ××§×‘×œ ×—×œ×§ ×§×‘×•×¢ ×‘×”×ª×× ×œ××¡×¤×¨ ×©×œ×•
            const assignmentDay = participantId;
            const chapters = tehillimDivision[assignmentDay] || [];
            
            return {
                participantId,
                assignmentDay,
                chapters,
                todayInfo
            };
        };

        // ×¤×•× ×§×¦×™×” ×œ×˜×¢×™× ×ª × ×ª×•× ×™ ××©×ª×ª×¤×™×
        const loadParticipants = () => {
            const savedData = localStorage.getItem('tehillimParticipants');
            if (savedData) {
                try {
                    return JSON.parse(savedData);
                } catch (e) {
                    console.error('Error parsing saved data:', e);
                }
            }
            
            // × ×ª×•× ×™× ×“×•×’××” ×× ××™×Ÿ × ×ª×•× ×™× ×©××•×¨×™×
            const defaultParticipants = [];
            for (let i = 1; i <= 30; i++) {
                defaultParticipants.push({
                    id: i,
                    name: `××©×ª×ª×£ ${i}`,
                    phone: `+972-50-000-${i.toString().padStart(4, '0')}`
                });
            }
            return defaultParticipants;
        };

        // ×¤×•× ×§×¦×™×•×ª WhatsApp
        const encodeWhatsAppMessage = (message) => {
            return encodeURIComponent(message);
        };

        const getAppUrl = () => {
            return window.location.href;
        };

        const createWhatsAppLink = (participant, todayInfo) => {
            const assignment = getParticipantAssignment(participant.id, todayInfo);
            const chaptersText = assignment.chapters.join('-');
            const appUrl = getAppUrl();
            
            const message = `ğŸ“– ×©×œ×•× ${participant.name}! 

ğŸ—“ï¸ ×”×™×•× ${todayInfo.hebrewDate}
ğŸ“Š ×™×•× ${todayInfo.cycleDay} ×‘××—×–×•×¨ ×”×ª×”×™×œ×™×

ğŸ“œ ×”×—×œ×§ ×©×œ×š ×œ×”×™×•×: ×¤×¨×§×™× ${chaptersText}

ğŸ¤ ×× ×›×•×œ× ×™×§×¨××• - × ×©×œ×™× ×™×—×“ ××ª ×›×œ ×”×ª×”×™×œ×™× ×”×™×•×! âœ¨

âœ… ×œ××™×©×•×¨ ×©×§×¨××ª: ${appUrl}
ğŸ“± ×œ×¦×¤×™×™×” ×‘×”×ª×§×“××•×ª: ${appUrl}

×ª×•×“×” ×©××ª×” ×—×œ×§ ××”××¢×’×œ ×”×§×“×•×©! ğŸ•¯ï¸`;

            // ×”×¡×¨×ª ×§×™×“×•××ª ×•××™× ×•×¡
            const cleanPhone = participant.phone.replace('+972-', '972').replace(/-/g, '');
            
            return `https://api.whatsapp.com/send?phone=${cleanPhone}&text=${encodeWhatsAppMessage(message)}`;
        };

        const createGroupWhatsAppLink = (todayInfo) => {
            const appUrl = getAppUrl();
            
            const message = `ğŸ•¯ï¸ ×§×¨×™××ª ×ª×”×™×œ×™× ×§×‘×•×¦×ª×™×ª - ×™×•× ${todayInfo.cycleDay} ×‘××—×–×•×¨

ğŸ“… ×”×™×•× ${todayInfo.hebrewDate}

ğŸ¤ ×‘×•××• × ×©×œ×™× ×™×—×“ ××ª ×›×œ ×”×ª×”×™×œ×™×! ×›×œ ××—×“ ×™×§×¨× ××ª ×”×—×œ×§ ×©×œ×•.

ğŸ“± ×œ×¦×¤×™×™×” ×‘×”×ª×§×“××•×ª ×•×œ××™×©×•×¨ ×§×¨×™××”: ${appUrl}

ğŸ“– ×‘×‘×¨×›×ª ×’××¨ ×”×ª×”×™×œ×™×! âœ¨`;

            return `https://api.whatsapp.com/send?text=${encodeWhatsAppMessage(message)}`;
        };

        // ×¨×›×™×‘ ×¢×™×’×•×œ ×”×ª×§×“××•×ª
        const ProgressCircle = ({ progress, total, label, color, size = 200 }) => {
            const radius = (size - 20) / 2;
            const circumference = radius * 2 * Math.PI;
            const strokeDasharray = circumference;
            const strokeDashoffset = circumference - (progress / total) * circumference;
            
            return (
                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', margin: '20px' }}>
                    <div style={{ position: 'relative' }}>
                        <svg width={size} height={size} className="progress-circle">
                            <circle
                                cx={size/2}
                                cy={size/2}
                                r={radius}
                                className="progress-circle-bg"
                            />
                            <circle
                                cx={size/2}
                                cy={size/2}
                                r={radius}
                                className={`progress-circle-fill ${color}`}
                                style={{
                                    strokeDasharray,
                                    strokeDashoffset
                                }}
                            />
                        </svg>
                        <div style={{
                            position: 'absolute',
                            top: 0,
                            left: 0,
                            width: '100%',
                            height: '100%',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center'
                        }}>
                            <div style={{ textAlign: 'center' }}>
                                <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#1f2937' }}>
                                    {progress}/{total}
                                </div>
                                <div style={{ fontSize: '14px', color: '#6b7280' }}>
                                    {Math.round((progress / total) * 100)}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style={{ marginTop: '16px', textAlign: 'center', fontWeight: '600', color: '#374151' }}>
                        {label}
                    </div>
                </div>
            );
        };

        // ×¨×›×™×‘ ×××©×§ ××©×ª×ª×£
        const ParticipantView = ({ participantId, onSwitchToAdmin }) => {
            const [todayInfo, setTodayInfo] = useState(getTodayInfo());
            const [participants, setParticipants] = useState([]);
            const [dailyCompletions, setDailyCompletions] = useState({});
            const [myCompletion, setMyCompletion] = useState(false);

            useEffect(() => {
                // ×¢×“×›×•×Ÿ ×ª××¨×™×š ×›×œ ×“×§×”
                const interval = setInterval(() => {
                    setTodayInfo(getTodayInfo());
                }, 60000);

                // ×˜×¢×™× ×ª × ×ª×•× ×™ ××©×ª×ª×¤×™×
                const loadedParticipants = loadParticipants();
                setParticipants(loadedParticipants);

                // ×˜×¢×™× ×ª ×”×©×œ××•×ª ××”×™×•×
                const today = new Date().toDateString();
                const savedCompletions = localStorage.getItem(`completions_${today}`);
                if (savedCompletions) {
                    const completions = JSON.parse(savedCompletions);
                    setDailyCompletions(completions);
                    setMyCompletion(completions[participantId] || false);
                }

                return () => clearInterval(interval);
            }, [participantId]);

            const toggleMyCompletion = () => {
                const newStatus = !myCompletion;
                setMyCompletion(newStatus);
                
                const newCompletions = {
                    ...dailyCompletions,
                    [participantId]: newStatus
                };
                setDailyCompletions(newCompletions);
                
                // ×©××™×¨×” ×œ×™×•× ×”× ×•×›×—×™
                const today = new Date().toDateString();
                localStorage.setItem(`completions_${today}`, JSON.stringify(newCompletions));
            };

            // ××¦×™××ª ×”××©×ª×ª×£ ×”× ×•×›×—×™
            const currentParticipant = participants.find(p => p.id === participantId) || 
                                    { id: participantId, name: `××©×ª×ª×£ ${participantId}`, phone: '' };
            
            const assignment = getParticipantAssignment(participantId, todayInfo);
            
            // ×—×™×©×•×‘ ×”×ª×§×“××•×ª
            const completedToday = Object.keys(dailyCompletions).filter(id => dailyCompletions[id]).length;
            const totalChapters = 150;
            const completedChapters = Object.keys(dailyCompletions).filter(id => dailyCompletions[id]).reduce((sum, id) => {
                const assignment = getParticipantAssignment(parseInt(id), todayInfo);
                return sum + assignment.chapters.length;
            }, 0);

            return (
                <div style={{ minHeight: '100vh', padding: '24px' }}>
                    <div style={{ maxWidth: '800px', margin: '0 auto' }}>
                        <h1 className="app-title" style={{ fontSize: '48px', fontWeight: 'bold', marginBottom: '32px' }}>
                            ğŸ•¯ï¸ ×§×¨×™××ª ×ª×”×™×œ×™× ×§×‘×•×¦×ª×™×ª ğŸ•¯ï¸
                        </h1>
                        
                        <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '20px', gap: '12px', flexWrap: 'wrap' }}>
                            <button 
                                onClick={onSwitchToAdmin}
                                className="btn btn-primary"
                            >
                                ğŸ‘¨â€ğŸ’¼ ××¢×‘×¨ ×œ×œ×•×— ×× ×”×œ
                            </button>
                        </div>

                        {/* ××™×“×¢ ×¢×œ ×”×ª××¨×™×š ×•×”××—×–×•×¨ */}
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '16px', marginBottom: '24px' }}>
                            <div className="date-info">
                                <h3 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '8px' }}>
                                    ğŸ“… ××™×“×¢ ×™×•××™
                                </h3>
                                <div>×”×™×•×: {todayInfo.hebrewDate}</div>
                                <div>×™×•× ×‘××—×–×•×¨: {todayInfo.cycleDay}/30</div>
                                <div>××ª×”: ××©×ª×ª×£ {participantId}</div>
                            </div>
                            
                            <div className="cycle-info">
                                <h3 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '8px' }}>
                                    ğŸ“– ×”×—×œ×§ ×©×œ×š ×”×™×•×
                                </h3>
                                <div style={{ fontSize: '18px', fontWeight: 'bold' }}>
                                    ×¤×¨×§×™×: {assignment.chapters.join('-')}
                                </div>
                                <div>
                                    {assignment.chapters.length} ×¤×¨×§×™× ×œ×”×™×•×
                                </div>
                            </div>
                        </div>

                        {/* ××™×©×•×¨ ×§×¨×™××” */}
                        <div className="card">
                            <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '16px', textAlign: 'center' }}>
                                ××™×©×•×¨ ×§×¨×™××ª ×”×ª×”×™×œ×™× ×©×œ×š
                            </h2>
                            <div className="chapter-display">
                                <div style={{ fontSize: '28px', fontWeight: 'bold', marginBottom: '12px' }}>
                                    ×¤×¨×§×™× {assignment.chapters.join('-')}
                                </div>
                                <div style={{ fontSize: '16px', color: '#6b7280', marginBottom: '20px' }}>
                                    {assignment.chapters.length} ×¤×¨×§×™× ×œ×™×•× {todayInfo.cycleDay} ×‘××—×–×•×¨
                                </div>
                                <button 
                                    onClick={toggleMyCompletion}
                                    className={`btn ${myCompletion ? 'btn-success' : 'btn-primary'}`}
                                    style={{ fontSize: '20px', padding: '16px 32px' }}
                                >
                                    {myCompletion ? 'âœ… ×§×¨××ª×™!' : 'ğŸ“– ×œ×—×¥ ××—×¨×™ ×©×§×¨××ª'}
                                </button>
                            </div>
                        </div>

                        {/* ×”×ª×§×“××•×ª ×”×§×‘×•×¦×” */}
                        <div className="card">
                            <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '16px', textAlign: 'center' }}>
                                ×”×ª×§×“××•×ª ×”×§×‘×•×¦×” ×™×•× {todayInfo.cycleDay}
                            </h2>
                            <div style={{ display: 'flex', justifyContent: 'center', flexWrap: 'wrap' }}>
                                <ProgressCircle 
                                    progress={completedChapters}
                                    total={totalChapters}
                                    label="×¤×¨×§×™× ×©× ×§×¨××• ×”×™×•×"
                                    color="daily-circle"
                                    size={180}
                                />
                                <ProgressCircle 
                                    progress={completedToday}
                                    total={participants.length}
                                    label="××©×ª×ª×¤×™× ×©×§×¨××•"
                                    color="monthly-circle"
                                    size={180}
                                />
                            </div>
                        </div>

                        {/* ×¨×©×™××ª ××©×ª×ª×¤×™× (×× ×•× ×™××™×ª) */}
                        <div className="card">
                            <h2 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '16px' }}>
                                ×”×ª×§×“××•×ª ××©×ª×ª×¤×™× ×™×•× {todayInfo.cycleDay}
                            </h2>
                            <div style={{ maxHeight: '300px', overflowY: 'auto' }}>
                                {participants.map(participant => {
                                    const assignment = getParticipantAssignment(participant.id, todayInfo);
                                    const hasCompleted = dailyCompletions[participant.id] || false;
                                    
                                    return (
                                        <div key={participant.id} className="participant-card">
                                            <div>
                                                <div style={{ fontWeight: '600' }}>
                                                    ××©×ª×ª×£ {participant.id}
                                                    {participant.id === participantId && ' (××ª×”)'}
                                                </div>
                                                <div style={{ fontSize: '14px', color: '#6b7280' }}>
                                                    ×¤×¨×§×™×: {assignment.chapters.join('-')}
                                                </div>
                                            </div>
                                            <div className={hasCompleted ? 'status-completed' : 'status-pending'}>
                                                {hasCompleted ? 'âœ… ×§×¨×' : 'â³ ×œ× ×§×¨×'}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // ×¨×›×™×‘ ×××©×§ ×× ×”×œ
        const AdminDashboard = ({ onSwitchToParticipant }) => {
            const [participants, setParticipants] = useState([]);
            const [todayInfo, setTodayInfo] = useState(getTodayInfo());
            const [dailyCompletions, setDailyCompletions] = useState({});

            useEffect(() => {
                // ×¢×“×›×•×Ÿ ×ª××¨×™×š ×›×œ ×“×§×”
                const interval = setInterval(() => {
                    setTodayInfo(getTodayInfo());
                }, 60000);

                // ×˜×¢×™× ×ª × ×ª×•× ×™ ××©×ª×ª×¤×™×
                const loadedParticipants = loadParticipants();
                setParticipants(loadedParticipants);

                // ×˜×¢×™× ×ª ×”×©×œ××•×ª ××”×™×•×
                const today = new Date().toDateString();
                const savedCompletions = localStorage.getItem(`completions_${today}`);
                if (savedCompletions) {
                    setDailyCompletions(JSON.parse(savedCompletions));
                }

                return () => clearInterval(interval);
            }, []);

            const toggleCompletion = (participantId) => {
                const newCompletions = {
                    ...dailyCompletions,
                    [participantId]: !dailyCompletions[participantId]
                };
                setDailyCompletions(newCompletions);
                
                // ×©××™×¨×” ×œ×™×•× ×”× ×•×›×—×™
                const today = new Date().toDateString();
                localStorage.setItem(`completions_${today}`, JSON.stringify(newCompletions));
            };

            const resetDailyData = () => {
                if (confirm('âš ï¸ ×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××¤×¡ ××ª × ×ª×•× ×™ ×”×™×•×?\n\n×›×œ ×”×§×¨×™××•×ª ×©×œ ×”×™×•× ×™××•×¤×¡×•.')) {
                    setDailyCompletions({});
                    const today = new Date().toDateString();
                    localStorage.removeItem(`completions_${today}`);
                    alert('ğŸ”„ × ×ª×•× ×™ ×”×™×•× ××•×¤×¡×• ×‘×”×¦×œ×—×”!');
                }
            };

            const resetCycle = () => {
                if (confirm('âš ï¸ ×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××¤×¡ ××ª ×”××—×–×•×¨ ×œ×ª×—×™×œ×”?\n\nâ€¢ ×”××—×–×•×¨ ×™×ª×—×™×œ ××™×•× 1\nâ€¢ ×›×œ ×”× ×ª×•× ×™× ×”×™×•××™×™× ×™××•×¤×¡×•\nâ€¢ ×”×ª××¨×™×š ×”×××™×ª×™ ×™×™×©××¨ ××•×ª×• ×“×‘×¨')) {
                    // ××™×¤×•×¡ × ×ª×•× ×™ ×”×©×œ××•×ª
                    setDailyCompletions({});
                    
                    // ××™×¤×•×¡ ×”××—×–×•×¨ ×œ×ª×—×™×œ×”
                    const newTodayInfo = {
                        ...todayInfo,
                        cycleDay: 1,
                        completedCycles: 0
                    };
                    setTodayInfo(newTodayInfo);
                    
                    // ×©××™×¨×ª ×”××™×¤×•×¡
                    localStorage.setItem('cycleOverride', JSON.stringify({
                        originalDate: new Date().toDateString(),
                        overrideCycleDay: 1
                    }));
                    
                    // ××—×™×§×ª × ×ª×•× ×™ ×”×©×œ××•×ª ××›×œ ×”×™××™×
                    const today = new Date().toDateString();
                    localStorage.removeItem(`completions_${today}`);
                    
                    alert('ğŸ”„ ×”××—×–×•×¨ ××•×¤×¡ ×œ×ª×—×™×œ×”!\n\n×¢×›×©×™×• ×”××¢×¨×›×ª ××¦×™×’×” ×™×•× 1 ×‘××—×–×•×¨.');
                }
            };

            const openDataManager = () => {
                alert('ğŸ’¡ ×¤×ª×— ××ª ×§×•×‘×¥ data-manager.html ×›×“×™ ×œ× ×”×œ ××ª ×¨×©×™××ª ×”××©×ª×ª×¤×™× ×•××¡×¤×¨×™ ×”×˜×œ×¤×•×Ÿ.');
            };

            // ×—×™×©×•×‘ ×”×ª×§×“××•×ª
            const completedToday = Object.keys(dailyCompletions).filter(id => dailyCompletions[id]).length;
            const totalChapters = 150;
            const completedChapters = Object.keys(dailyCompletions).filter(id => dailyCompletions[id]).reduce((sum, id) => {
                const assignment = getParticipantAssignment(parseInt(id), todayInfo);
                return sum + assignment.chapters.length;
            }, 0);

            const dataSource = participants.length > 0 && participants[0].name !== `××©×ª×ª×£ 1` ? '××“×£ × ×™×”×•×œ ×”× ×ª×•× ×™×' : '× ×ª×•× ×™ ×“×•×’××”';

            return (
                <div style={{ minHeight: '100vh', padding: '24px' }}>
                    <div style={{ maxWidth: '1200px', margin: '0 auto' }}>
                        <h1 className="app-title" style={{ fontSize: '48px', fontWeight: 'bold', marginBottom: '32px' }}>
                            ğŸ•¯ï¸ ×œ×•×— ×× ×”×œ - ×§×¨×™××ª ×ª×”×™×œ×™× ×§×‘×•×¦×ª×™×ª ğŸ•¯ï¸
                        </h1>
                        
                        {/* ××™×“×¢ ×¢×œ ××§×•×¨ ×”× ×ª×•× ×™× */}
                        <div className="data-source-info">
                            <h3 style={{ fontSize: '18px', fontWeight: 'bold', marginBottom: '8px' }}>
                                ğŸ“Š ××§×•×¨ ×”× ×ª×•× ×™×: {dataSource}
                            </h3>
                            {dataSource === '× ×ª×•× ×™ ×“×•×’××”' && (
                                <p style={{ margin: 0 }}>
                                    ×œ×©×™××•×© ×¢× × ×ª×•× ×™× ×××™×ª×™×™×, ×”×©×ª××© ×‘×“×£ × ×™×”×•×œ ×”× ×ª×•× ×™× ×œ×”×›× ×¡×ª ×©××•×ª ×•×˜×œ×¤×•× ×™×
                                </p>
                            )}
                        </div>
                        
                        {/* ××™×“×¢ ×¢×œ ×”×ª××¨×™×š ×•×”××—×–×•×¨ */}
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '16px', marginBottom: '24px' }}>
                            <div className="date-info">
                                <h3 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '8px' }}>
                                    ğŸ“… ××™×“×¢ ×™×•××™
                                </h3>
                                <div>×”×™×•×: {todayInfo.hebrewDate}</div>
                                <div>×™×•× ×‘××—×–×•×¨: {todayInfo.cycleDay}/30</div>
                                <div>××—×–×•×¨×™× ×©×”×•×©×œ××• ×”×—×•×“×©: {todayInfo.completedCycles}</div>
                            </div>
                            
                            <div className="cycle-info">
                                <h3 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '8px' }}>
                                    ğŸ”„ ××¦×‘ ×”××—×–×•×¨
                                </h3>
                                <div>×”××¢×¨×›×ª ××ª×¢×“×›× ×ª ××•×˜×•××˜×™×ª!</div>
                                <div>×›×œ ×™×•× = ×—×œ×•×§×” ×—×“×©×”</div>
                                <div>×¨×§ ×©×œ×— ×ª×–×›×•×¨×ª ×™×•××™×ª ğŸ“±</div>
                            </div>
                        </div>
                        
                        <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '20px', gap: '12px', flexWrap: 'wrap' }}>
                            <button 
                                onClick={() => onSwitchToParticipant(1)}
                                className="btn btn-primary"
                            >
                                ğŸ‘¤ ××¢×‘×¨ ×œ×ª×¦×•×’×ª ××©×ª×ª×£
                            </button>
                            
                            <button 
                                onClick={openDataManager}
                                className="btn btn-warning"
                            >
                                ğŸ”§ × ×™×”×•×œ × ×ª×•× ×™×
                            </button>
                            
                            <button 
                                onClick={resetDailyData}
                                className="btn btn-danger"
                            >
                                ğŸ”„ ××™×¤×•×¡ ×™×•×
                            </button>

                            <button 
                                onClick={resetCycle}
                                className="btn btn-danger"
                                style={{ backgroundColor: '#dc2626' }}
                            >
                                ğŸ”„ ××™×¤×•×¡ ××—×–×•×¨ ×œ×ª×—×™×œ×”
                            </button>
                        </div>

                        {/* ×”×ª×§×“××•×ª ×”×™×•× */}
                        <div className="card">
                            <h2 style={{ fontSize: '32px', fontWeight: 'bold', marginBottom: '24px', textAlign: 'center' }}>
                                ×”×ª×§×“××•×ª ×™×•× {todayInfo.cycleDay} ×‘××—×–×•×¨
                            </h2>
                            <div style={{ display: 'flex', justifyContent: 'center', flexWrap: 'wrap' }}>
                                <ProgressCircle 
                                    progress={completedChapters}
                                    total={totalChapters}
                                    label="×¤×¨×§×™× ×©× ×§×¨××• ×”×™×•× ×‘×§×‘×•×¦×”"
                                    color="daily-circle"
                                    size={200}
                                />
                                <ProgressCircle 
                                    progress={completedToday}
                                    total={participants.length}
                                    label="××©×ª×ª×¤×™× ×©×§×¨××• ×”×™×•×"
                                    color="monthly-circle"
                                    size={200}
                                />
                            </div>
                        </div>

                        {/* ×©×œ×™×—×ª ×”×•×“×¢×•×ª */}
                        <div className="card">
                            <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '16px' }}>
                                ×©×œ×™×—×ª ×ª×–×›×•×¨×ª ×™×•××™×ª
                            </h2>
                            <p style={{ marginBottom: '16px', color: '#6b7280' }}>
                                ×”××¢×¨×›×ª ×ª×›×™×Ÿ ×”×•×“×¢×” ××™×©×™×ª ×œ×›×œ ××©×ª×ª×£ ×¢× ×”×©× ×”×××™×ª×™ ×©×œ×• ×•×”×—×œ×§ ×©×œ×• ×œ×™×•× {todayInfo.cycleDay} ×‘××—×–×•×¨
                            </p>
                            <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
                                <button 
                                    onClick={() => alert(`ğŸ‰ ×›×¤×ª×•×¨×™× ××™×©×™×™× ×–××™× ×™× ×œ×™×“ ×›×œ ××©×ª×ª×£!\n\n×œ×—×¥ ×¢×œ "ğŸ“± ×©×œ×— ×•×•××˜×¡××¤" ×œ×™×“ ×”××©×ª×ª×£ ×©×ª×¨×¦×” ×œ×©×œ×•×— ×œ×• ×”×•×“×¢×”.`)}
                                    className="btn btn-success"
                                    style={{ flex: '1', fontSize: '18px' }}
                                >
                                    ğŸ“± ×”×›×Ÿ ×”×•×“×¢×•×ª ××™×©×™×•×ª ×™×•× {todayInfo.cycleDay}
                                </button>
                                <button 
                                    onClick={() => window.open(createGroupWhatsAppLink(todayInfo), '_blank')}
                                    className="btn btn-primary"
                                    style={{ fontSize: '18px' }}
                                >
                                    ğŸ“± ×©×œ×— ×”×•×“×¢×” ×œ×§×‘×•×¦×” ×™×•× {todayInfo.cycleDay}
                                </button>
                            </div>
                        </div>

                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))', gap: '32px' }}>
                            {/* ×¨×©×™××ª ××©×ª×ª×¤×™× */}
                            <div className="card">
                                <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '16px' }}>
                                    ×¨×©×™××ª ××©×ª×ª×¤×™× ({participants.length})
                                </h2>
                                
                                <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                    {participants.map(participant => {
                                        const assignment = getParticipantAssignment(participant.id, todayInfo);
                                        return (
                                            <div key={participant.id} className="participant-card">
                                                <div>
                                                    <div style={{ fontWeight: '600', fontSize: '16px' }}>{participant.name}</div>
                                                    <div style={{ fontSize: '14px', color: '#6b7280' }}>
                                                        {participant.phone} | ×¤×¨×§×™×: {assignment.chapters.join('-')}
                                                    </div>
                                                </div>
                                                <button 
                                                    onClick={() => window.open(createWhatsAppLink(participant, todayInfo), '_blank')}
                                                    className="btn btn-success"
                                                    style={{ padding: '8px 12px', fontSize: '14px' }}
                                                >
                                                    ğŸ“± ×©×œ×— ×•×•××˜×¡××¤
                                                </button>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* ×”×ª×§×“××•×ª ×™×•××™×ª ××¤×•×¨×˜×ª */}
                            <div className="card">
                                <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '16px' }}>
                                    ×”×ª×§×“××•×ª ×™×•× {todayInfo.cycleDay} (×œ×—×¥ ×œ×¢×“×›×•×Ÿ)
                                </h2>
                                <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                    {participants.map(participant => {
                                        const assignment = getParticipantAssignment(participant.id, todayInfo);
                                        const hasCompleted = dailyCompletions[participant.id] || false;
                                        
                                        return (
                                            <div 
                                                key={participant.id} 
                                                className="participant-card"
                                                style={{ cursor: 'pointer' }}
                                                onClick={() => toggleCompletion(participant.id)}
                                            >
                                                <div>
                                                    <div style={{ fontWeight: '600' }}>{participant.name}</div>
                                                    <div style={{ fontSize: '14px', color: '#6b7280' }}>
                                                        ×¤×¨×§×™×: {assignment.chapters.join('-')}
                                                    </div>
                                                </div>
                                                <div className={hasCompleted ? 'status-completed' : 'status-pending'}>
                                                    {hasCompleted ? 'âœ… ×§×¨×' : 'â³ ×œ× ×§×¨×'}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // ×¨×›×™×‘ ×¨××©×™
        const App = () => {
            const [currentView, setCurrentView] = useState('admin');
            const [participantId, setParticipantId] = useState(1);

            const switchToAdmin = () => {
                setCurrentView('admin');
            };

            const switchToParticipant = (id) => {
                setParticipantId(id);
                setCurrentView('participant');
            };

            return (
                <div>
                    {currentView === 'admin' ? (
                        <AdminDashboard onSwitchToParticipant={switchToParticipant} />
                    ) : (
                        <ParticipantView 
                            participantId={participantId} 
                            onSwitchToAdmin={switchToAdmin} 
                        />
                    )}
                </div>
            );
        };

        // ×¨×™× ×“×•×¨ ×”××¤×œ×™×§×¦×™×”
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>